utility functions for version 2 --- have great power and speed