utility functions for version 2 --- have great efficiency